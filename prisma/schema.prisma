// schema.prisma

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider  = "postgresql"
    url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
    directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model Entity {
    id                Int         @id @default(autoincrement())
    farcasterAccounts Farcaster[]
    ethereumAccounts  Ethereum[]
    links             Link[]
}

model Farcaster {
    fid      Int     @id
    fname    String?
    pfp      String?
    display  String?
    bio      String?
    source   String
    verified Boolean

    entity   Entity @relation(fields: [entityId], references: [id])
    entityId Int
}

model Ethereum {
    address     String  @id
    source      String
    verified    Boolean
    sourceInput String?

    Entity   Entity? @relation(fields: [entityId], references: [id])
    entityId Int
}

model Link {
    url         String
    metadata    Json?
    source      String
    verified    Boolean
    sourceInput String?

    Entity   Entity? @relation(fields: [entityId], references: [id])
    entityId Int

    @@id([url, entityId, source])
}

model Backfill {
    fid Int @id
}
